---
sections:
  - title: "SonarMark Requirements"
    sections:
      - title: "Command-Line Interface"
        requirements:
          - id: "CLI-001"
            title: "The tool shall provide a command-line interface."
            tests:
              - "Context_Create_NoArguments_ReturnsDefaultContext"
              - "Context_Create_UnsupportedArgument_ThrowsException"

          - id: "CLI-002"
            title: "The tool shall display version information when requested."
            tests:
              - "Program_Version_NotEmpty_IsNotEmpty"
              - "Program_Run_VersionFlag_OutputsVersion"
              - "Context_Create_VersionFlag_SetsVersionProperty"
              - "IntegrationTest_VersionFlag_OutputsVersion"

          - id: "CLI-003"
            title: "The tool shall display help information when requested."
            tests:
              - "Program_Run_HelpFlag_OutputsBannerAndHelp"
              - "Context_Create_HelpFlags_SetsHelpProperty"
              - "IntegrationTest_HelpFlag_OutputsUsageInformation"

          - id: "CLI-004"
            title: "The tool shall support silent mode to suppress console output."
            tests:
              - "Context_Create_SilentFlag_SetsSilentProperty"
              - "Context_WriteLine_SilentMode_DoesNotWriteToConsole"
              - "Context_WriteError_SilentMode_DoesNotWriteToConsole"

          - id: "CLI-005"
            title: "The tool shall support writing output to a log file."
            tests:
              - "Context_Create_WithLogFile_WritesToLogFile"
              - "Context_Create_MissingLogFilename_ThrowsException"
              - "Context_Create_InvalidLogFilePath_ThrowsException"

      - title: "SonarQube/SonarCloud Integration"
        requirements:
          - id: "SONAR-001"
            title: "The tool shall connect to SonarQube/SonarCloud servers."
            tests:
              - "Context_Create_Server_SetsServerProperty"
              - "Context_Create_MissingServer_ThrowsException"
              - "Program_Run_NoFlags_OutputsBannerAndRequiresServer"

          - id: "SONAR-002"
            title: "The tool shall authenticate with SonarQube/SonarCloud using tokens."
            tests:
              - "Context_Create_Token_SetsTokenProperty"
              - "Context_Create_MissingToken_ThrowsException"

          - id: "SONAR-003"
            title: "The tool shall fetch quality gate status from SonarQube/SonarCloud."
            tests:
              - "SonarQualityResult_Constructor_AllProperties_CreatesInstance"
              - "SonarQualityCondition_Constructor_AllProperties_CreatesInstance"

          - id: "SONAR-004"
            title: "The tool shall fetch issues from SonarQube/SonarCloud."
            tests:
              - "SonarIssue_Constructor_AllProperties_CreatesInstance"
              - "SonarIssue_Constructor_CriticalSeverity_CreatesInstance"
              - "SonarIssue_Constructor_BlockerSeverity_CreatesInstance"
              - "SonarIssue_Constructor_InfoSeverity_CreatesInstance"
              - "SonarIssue_Constructor_NullLine_CreatesInstance"

          - id: "SONAR-005"
            title: "The tool shall fetch security hot-spots from SonarQube/SonarCloud."
            tests:
              - "SonarHotSpot_Constructor_AllProperties_CreatesInstance"
              - "SonarHotSpot_Constructor_LowProbability_CreatesInstance"
              - "SonarHotSpot_Constructor_NullLine_CreatesInstance"

          - id: "SONAR-006"
            title: "The tool shall support filtering by project key."
            tests:
              - "Context_Create_ProjectKey_SetsProjectKeyProperty"
              - "Context_Create_MissingProjectKey_ThrowsException"

          - id: "SONAR-007"
            title: "The tool shall support filtering by branch."
            tests:
              - "Context_Create_Branch_SetsBranchProperty"
              - "Context_Create_MissingBranch_ThrowsException"

      - title: "Report Generation"
        requirements:
          - id: "RPT-001"
            title: "The tool shall generate markdown reports."
            tests:
              - "Context_Create_ReportFile_SetsReportProperty"
              - "Context_Create_MissingReportFilename_ThrowsException"
              - "IntegrationTest_ReportParameter_IsAccepted"

          - id: "RPT-002"
            title: "The tool shall support configurable report depth."
            tests:
              - "Context_Create_ReportDepth_SetsReportDepthProperty"
              - "Context_Create_MissingReportDepth_ThrowsException"
              - "Context_Create_InvalidReportDepth_ThrowsException"

          - id: "RPT-003"
            title: "The tool shall include quality gate status in reports."
            tests:
              - "SonarQualityResult_ToMarkdown_Depth1_ProducesCorrectOutput"
              - "SonarQualityResult_ToMarkdown_Depth3_UsesCorrectHeadingLevels"
              - "SonarQualityResult_ToMarkdown_Depth6_ProducesCorrectOutput"
              - "SonarQualityResult_ToMarkdown_NoConditions_ExcludesConditionsSection"
              - "SonarQualityResult_ToMarkdown_WarnStatus_ProducesCorrectOutput"
              - "SonarQualityResult_ToMarkdown_WithFriendlyNames_UsesFriendlyNames"

          - id: "RPT-004"
            title: "The tool shall categorize and report issues by type and severity."
            tests:
              - "SonarQualityResult_ToMarkdown_WithIssues_ProducesCompilerStyleOutput"
              - "SonarQualityResult_ToMarkdown_WithSingularCounts_ShowsCorrectText"

          - id: "RPT-005"
            title: "The tool shall report security hot-spots requiring review."
            tests:
              - "SonarQualityResult_ToMarkdown_WithHotSpots_ProducesCompilerStyleOutput"

      - title: "Validation and Testing"
        requirements:
          - id: "VAL-001"
            title: "The tool shall support self-validation mode."
            tests:
              - "Program_Run_ValidateFlag_OutputsNotImplemented"
              - "Context_Create_ValidateFlag_SetsValidateProperty"

          - id: "VAL-002"
            title: "The tool shall write validation results to test result files."
            tests:
              - "Context_Create_ResultsFile_SetsResultsProperty"
              - "Context_Create_MissingResultsFilename_ThrowsException"

          - id: "VAL-003"
            title: "The tool shall support TRX format for test results."
            tests:
              - "Context_Create_ResultsFile_SetsResultsProperty"

          - id: "VAL-004"
            title: "The tool shall support JUnit format for test results."
            tests:
              - "Context_Create_ResultsFile_SetsResultsProperty"

      - title: "Quality Enforcement"
        requirements:
          - id: "ENF-001"
            title: "The tool shall support enforcement mode to fail on quality gate failures."
            tests:
              - "Context_Create_EnforceFlag_SetsEnforceProperty"

          - id: "ENF-002"
            title: "The tool shall return non-zero exit code when quality gate fails in enforcement mode."
            tests:
              - "IntegrationTest_EnforceFlag_IsAccepted"

      - title: "Platform Support"
        requirements:
          - id: "PLT-001"
            title: "The tool shall run on Windows operating systems."
            tests:
              - "windows-latest@Program_Version_NotEmpty_IsNotEmpty"
              - "windows-latest@IntegrationTest_VersionFlag_OutputsVersion"
              - "windows-latest@IntegrationTest_HelpFlag_OutputsUsageInformation"
              - "windows-latest@IntegrationTest_ReportParameter_IsAccepted"

          - id: "PLT-002"
            title: "The tool shall run on Linux operating systems."
            tests:
              - "ubuntu-latest@Program_Version_NotEmpty_IsNotEmpty"
              - "ubuntu-latest@IntegrationTest_VersionFlag_OutputsVersion"
              - "ubuntu-latest@IntegrationTest_HelpFlag_OutputsUsageInformation"
              - "ubuntu-latest@IntegrationTest_ReportParameter_IsAccepted"

          - id: "PLT-003"
            title: "The tool shall support .NET 8.0 runtime."
            tests:
              - "dotnet8.x@IntegrationTest_VersionFlag_OutputsVersion"
              - "dotnet8.x@IntegrationTest_HelpFlag_OutputsUsageInformation"
              - "dotnet8.x@IntegrationTest_ReportParameter_IsAccepted"

          - id: "PLT-004"
            title: "The tool shall support .NET 9.0 runtime."
            tests:
              - "dotnet9.x@IntegrationTest_VersionFlag_OutputsVersion"
              - "dotnet9.x@IntegrationTest_HelpFlag_OutputsUsageInformation"
              - "dotnet9.x@IntegrationTest_ReportParameter_IsAccepted"

          - id: "PLT-005"
            title: "The tool shall support .NET 10.0 runtime."
            tests:
              - "dotnet10.x@IntegrationTest_VersionFlag_OutputsVersion"
              - "dotnet10.x@IntegrationTest_HelpFlag_OutputsUsageInformation"
              - "dotnet10.x@IntegrationTest_ReportParameter_IsAccepted"
